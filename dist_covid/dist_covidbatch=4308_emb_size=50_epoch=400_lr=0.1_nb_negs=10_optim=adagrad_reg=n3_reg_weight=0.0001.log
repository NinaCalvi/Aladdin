./test2.py --data covid --model distmult --batch-size 4308 --epochs 400 --embedding-size 50 --learning-rate 0.1 --regulariser n3 --reg-weight 0.0001 --optimizer adagrad --loss pw_square --nb-negs 10 --valid --quiet
MCL False
INFO:test2.py:Valid: True
INFO:test2.py:Device: cuda
<class 'biolink.embeddings.models.DistMult'>
INFO:test2.py:NOT MC
INFO:test2.py:Device: cuda
INFO:test2.py:valid: True
INFO:test2.py:Epoch 1/400	Loss 14315.9909 ± 11217.2184
INFO:test2.py:Epoch 2/400	Loss 5927.5295 ± 605.7700
INFO:test2.py:Epoch 3/400	Loss 5072.9684 ± 505.2619
INFO:test2.py:Epoch 4/400	Loss 4719.4944 ± 472.1064
INFO:test2.py:Epoch 5/400	Loss 4497.4056 ± 450.6792
INFO:test2.py:Epoch 6/400	Loss 4357.5316 ± 438.7413
INFO:test2.py:Epoch 7/400	Loss 4242.6176 ± 426.7958
INFO:test2.py:Epoch 8/400	Loss 4163.2060 ± 419.7895
INFO:test2.py:Epoch 9/400	Loss 4099.1748 ± 410.8048
INFO:test2.py:Epoch 10/400	Loss 4038.5486 ± 407.2225
INFO:test2.py:Epoch 11/400	Loss 3994.2883 ± 400.7323
INFO:test2.py:Epoch 12/400	Loss 3955.8390 ± 398.3371
INFO:test2.py:Epoch 13/400	Loss 3924.1806 ± 393.3985
INFO:test2.py:Epoch 14/400	Loss 3892.2985 ± 390.6111
INFO:test2.py:Epoch 15/400	Loss 3861.1217 ± 388.2125
INFO:test2.py:Epoch 16/400	Loss 3839.4067 ± 385.0278
INFO:test2.py:Epoch 17/400	Loss 3822.9228 ± 384.2561
INFO:test2.py:Epoch 18/400	Loss 3804.9297 ± 382.1947
INFO:test2.py:Epoch 19/400	Loss 3783.0824 ± 380.6508
INFO:test2.py:Epoch 20/400	Loss 3771.8605 ± 378.7720
INFO:test2.py:Epoch 21/400	Loss 3754.3883 ± 376.4784
INFO:test2.py:Epoch 22/400	Loss 3739.5088 ± 376.1495
INFO:test2.py:Epoch 23/400	Loss 3727.8195 ± 373.4201
INFO:test2.py:Epoch 24/400	Loss 3714.4325 ± 372.5983
INFO:test2.py:Epoch 25/400	Loss 3707.4383 ± 372.2542
INFO:test2.py:Epoch 26/400	Loss 3692.5719 ± 370.8573
INFO:test2.py:Epoch 27/400	Loss 3681.1242 ± 368.5320
INFO:test2.py:Epoch 28/400	Loss 3674.4830 ± 367.2528
INFO:test2.py:Epoch 29/400	Loss 3671.1016 ± 367.8226
INFO:test2.py:Epoch 30/400	Loss 3658.2521 ± 366.2688
INFO:test2.py:Epoch 31/400	Loss 3651.2366 ± 365.3246
INFO:test2.py:Epoch 32/400	Loss 3646.8554 ± 365.4249
INFO:test2.py:Epoch 33/400	Loss 3639.9136 ± 364.8860
INFO:test2.py:Epoch 34/400	Loss 3634.2850 ± 363.1832
INFO:test2.py:Epoch 35/400	Loss 3625.9623 ± 364.0921
INFO:test2.py:Epoch 36/400	Loss 3622.2773 ± 362.1476
INFO:test2.py:Epoch 37/400	Loss 3609.9182 ± 360.8798
INFO:test2.py:Epoch 38/400	Loss 3608.2118 ± 359.0167
INFO:test2.py:Epoch 39/400	Loss 3604.4760 ± 360.0381
INFO:test2.py:Epoch 40/400	Loss 3592.6718 ± 360.3270
INFO:test2.py:Epoch 41/400	Loss 3589.1513 ± 360.2579
INFO:test2.py:Epoch 42/400	Loss 3586.6909 ± 358.7373
INFO:test2.py:Epoch 43/400	Loss 3582.7454 ± 358.7906
INFO:test2.py:Epoch 44/400	Loss 3579.4630 ± 359.1959
INFO:test2.py:Epoch 45/400	Loss 3572.6896 ± 357.3232
INFO:test2.py:Epoch 46/400	Loss 3566.3673 ± 355.9023
INFO:test2.py:Epoch 47/400	Loss 3575.8331 ± 357.3153
INFO:test2.py:Epoch 48/400	Loss 3562.9995 ± 357.2558
INFO:test2.py:Epoch 49/400	Loss 3562.0869 ± 355.7129
INFO:test2.py:Epoch 50/400	Loss 3558.0892 ± 356.7256
INFO:test2.py:Validating
INFO:test2.py:done
INFO:test2.py:metrics done
INFO:test2.py:Applying old dog tricks, ending training. MRR is 0.04865706885910489
INFO:test2.py:Epoch 51/400	Loss 3561.8155 ± 356.4643
INFO:test2.py:Epoch 52/400	Loss 3548.1642 ± 354.7619
INFO:test2.py:Epoch 53/400	Loss 3549.2184 ± 355.0798
INFO:test2.py:Epoch 54/400	Loss 3542.3996 ± 354.6711
INFO:test2.py:Epoch 55/400	Loss 3537.5255 ± 354.4859
INFO:test2.py:Epoch 56/400	Loss 3537.7619 ± 353.7367
INFO:test2.py:Epoch 57/400	Loss 3539.4646 ± 353.0894
INFO:test2.py:Epoch 58/400	Loss 3538.4304 ± 353.2171
INFO:test2.py:Epoch 59/400	Loss 3534.2985 ± 353.2425
INFO:test2.py:Epoch 60/400	Loss 3528.9689 ± 354.2106
INFO:test2.py:Epoch 61/400	Loss 3517.7839 ± 351.3147
INFO:test2.py:Epoch 62/400	Loss 3523.8985 ± 352.8814
INFO:test2.py:Epoch 63/400	Loss 3514.9565 ± 350.0355
INFO:test2.py:Epoch 64/400	Loss 3518.0319 ± 351.6752
INFO:test2.py:Epoch 65/400	Loss 3513.9733 ± 352.0141
INFO:test2.py:Epoch 66/400	Loss 3511.4758 ± 351.3963
INFO:test2.py:Epoch 67/400	Loss 3519.6797 ± 352.3448
INFO:test2.py:Epoch 68/400	Loss 3505.6969 ± 350.0145
INFO:test2.py:Epoch 69/400	Loss 3506.9392 ± 350.5516
INFO:test2.py:Epoch 70/400	Loss 3504.6339 ± 350.5483
INFO:test2.py:Epoch 71/400	Loss 3509.6372 ± 351.1230
INFO:test2.py:Epoch 72/400	Loss 3499.4471 ± 349.2990
INFO:test2.py:Epoch 73/400	Loss 3503.7171 ± 352.0447
INFO:test2.py:Epoch 74/400	Loss 3491.9554 ± 349.7851
INFO:test2.py:Epoch 75/400	Loss 3496.6931 ± 349.8553
INFO:test2.py:Epoch 76/400	Loss 3489.4957 ± 348.1345
INFO:test2.py:Epoch 77/400	Loss 3489.6492 ± 349.3624
INFO:test2.py:Epoch 78/400	Loss 3493.2441 ± 348.8116
INFO:test2.py:Epoch 79/400	Loss 3491.1322 ± 350.0115
INFO:test2.py:Epoch 80/400	Loss 3486.1728 ± 347.7650
INFO:test2.py:Epoch 81/400	Loss 3478.6113 ± 347.0105
INFO:test2.py:Epoch 82/400	Loss 3488.3560 ± 347.6561
INFO:test2.py:Epoch 83/400	Loss 3486.2438 ± 348.7536
INFO:test2.py:Epoch 84/400	Loss 3476.4975 ± 346.8467
INFO:test2.py:Epoch 85/400	Loss 3477.6746 ± 346.8463
INFO:test2.py:Epoch 86/400	Loss 3478.1315 ± 347.1248
INFO:test2.py:Epoch 87/400	Loss 3476.3262 ± 347.5902
INFO:test2.py:Epoch 88/400	Loss 3480.0007 ± 347.9956
INFO:test2.py:Epoch 89/400	Loss 3474.6609 ± 347.2965
INFO:test2.py:Epoch 90/400	Loss 3477.8153 ± 348.5276
INFO:test2.py:Epoch 91/400	Loss 3474.2672 ± 347.5175
INFO:test2.py:Epoch 92/400	Loss 3470.0635 ± 348.1352
INFO:test2.py:Epoch 93/400	Loss 3469.6802 ± 346.4087
INFO:test2.py:Epoch 94/400	Loss 3471.8117 ± 346.8481
INFO:test2.py:Epoch 95/400	Loss 3466.2357 ± 345.5158
INFO:test2.py:Epoch 96/400	Loss 3463.6664 ± 346.1991
INFO:test2.py:Epoch 97/400	Loss 3465.7147 ± 346.8779
INFO:test2.py:Epoch 98/400	Loss 3458.5923 ± 345.0477
INFO:test2.py:Epoch 99/400	Loss 3462.9934 ± 345.4606
INFO:test2.py:Epoch 100/400	Loss 3462.1288 ± 344.8015
INFO:test2.py:Validating
INFO:test2.py:done
INFO:test2.py:metrics done
INFO:test2.py:Best validation metrics 0.04874576208294938
INFO:test2.py:Epoch 101/400	Loss 3458.2464 ± 345.4368
INFO:test2.py:Epoch 102/400	Loss 3456.6635 ± 345.2426
INFO:test2.py:Epoch 103/400	Loss 3452.8288 ± 345.3237
INFO:test2.py:Epoch 104/400	Loss 3455.8960 ± 344.3379
INFO:test2.py:Epoch 105/400	Loss 3455.3129 ± 343.7923
INFO:test2.py:Epoch 106/400	Loss 3455.2669 ± 345.3684
INFO:test2.py:Epoch 107/400	Loss 3453.0218 ± 344.0731
INFO:test2.py:Epoch 108/400	Loss 3450.7192 ± 344.9839
INFO:test2.py:Epoch 109/400	Loss 3451.1883 ± 344.4010
INFO:test2.py:Epoch 110/400	Loss 3450.1064 ± 344.3452
INFO:test2.py:Epoch 111/400	Loss 3452.5894 ± 344.2566
INFO:test2.py:Epoch 112/400	Loss 3447.0141 ± 344.5966
INFO:test2.py:Epoch 113/400	Loss 3446.6915 ± 344.1420
INFO:test2.py:Epoch 114/400	Loss 3445.9422 ± 344.0485
INFO:test2.py:Epoch 115/400	Loss 3450.9572 ± 345.2283
INFO:test2.py:Epoch 116/400	Loss 3446.2117 ± 344.5031
INFO:test2.py:Epoch 117/400	Loss 3442.3439 ± 344.0291
INFO:test2.py:Epoch 118/400	Loss 3439.8563 ± 343.4366
INFO:test2.py:Epoch 119/400	Loss 3436.2894 ± 343.5687
INFO:test2.py:Epoch 120/400	Loss 3438.8873 ± 342.6773
INFO:test2.py:Epoch 121/400	Loss 3436.7345 ± 342.2781
INFO:test2.py:Epoch 122/400	Loss 3434.3530 ± 342.7869
INFO:test2.py:Epoch 123/400	Loss 3435.6826 ± 343.0352
INFO:test2.py:Epoch 124/400	Loss 3436.7027 ± 342.7802
INFO:test2.py:Epoch 125/400	Loss 3435.6424 ± 343.6553
INFO:test2.py:Epoch 126/400	Loss 3429.7066 ± 341.2981
INFO:test2.py:Epoch 127/400	Loss 3431.6879 ± 343.4974
INFO:test2.py:Epoch 128/400	Loss 3424.5542 ± 341.4662
INFO:test2.py:Epoch 129/400	Loss 3428.1008 ± 343.0197
INFO:test2.py:Epoch 130/400	Loss 3433.4180 ± 342.6817
INFO:test2.py:Epoch 131/400	Loss 3426.2008 ± 342.2810
INFO:test2.py:Epoch 132/400	Loss 3426.8128 ± 342.8336
INFO:test2.py:Epoch 133/400	Loss 3430.3821 ± 342.7926
INFO:test2.py:Epoch 134/400	Loss 3431.0591 ± 341.7688
INFO:test2.py:Epoch 135/400	Loss 3424.7935 ± 341.6867
INFO:test2.py:Epoch 136/400	Loss 3428.1030 ± 342.6828
INFO:test2.py:Epoch 137/400	Loss 3424.8373 ± 341.8479
INFO:test2.py:Epoch 138/400	Loss 3423.6634 ± 341.4886
INFO:test2.py:Epoch 139/400	Loss 3424.2491 ± 341.9549
INFO:test2.py:Epoch 140/400	Loss 3427.7649 ± 341.9135
INFO:test2.py:Epoch 141/400	Loss 3421.9872 ± 340.8390
INFO:test2.py:Epoch 142/400	Loss 3418.9729 ± 340.9404
INFO:test2.py:Epoch 143/400	Loss 3423.0476 ± 341.7166
INFO:test2.py:Epoch 144/400	Loss 3418.6993 ± 341.5163
INFO:test2.py:Epoch 145/400	Loss 3421.4217 ± 341.9222
INFO:test2.py:Epoch 146/400	Loss 3422.6898 ± 341.3937
INFO:test2.py:Epoch 147/400	Loss 3411.0016 ± 340.0218
INFO:test2.py:Epoch 148/400	Loss 3418.8206 ± 340.8852
INFO:test2.py:Epoch 149/400	Loss 3414.8859 ± 340.0793
INFO:test2.py:Epoch 150/400	Loss 3413.0655 ± 340.9600
INFO:test2.py:Validating
INFO:test2.py:done
INFO:test2.py:metrics done
INFO:test2.py:Filtered MRR validation decreased, therefore stop
INFO:test2.py:Best validation metrics 0.04874576208294938
INFO:test2.py:is bad performing False
INFO:test2.py:Done training
INFO:test2.py:in evalute for dataset: 	valid
INFO:test2.py:done
INFO:test2.py:metrics done
INFO:test2.py:Error 	valid results	MRR 0.048690	H@1 0.015734	H@3 0.038732	H@10 0.098826	AU-ROC_raw -1.000000	AU-ROC_fil -1.000000
INFO:test2.py:in evalute for dataset: 	test
INFO:test2.py:done
INFO:test2.py:metrics done
INFO:test2.py:Error 	test results	MRR 0.048767	H@1 0.016117	H@3 0.038724	H@10 0.099441	AU-ROC_raw -1.000000	AU-ROC_fil -1.000000
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/acalvi/anaconda3/envs/libkge_new/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
